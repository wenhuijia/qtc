<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="format-detection" content="telephone=no">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <!--content有两个值”yes”和”no”,当我们需要显示工具栏和菜单栏时，这个行meta就不用加了，默认就是显示。-->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="format-detection" content="email=no" />
  <title>牵台车</title>
  <script type="text/javascript" src="js/public.js"></script>
  <link rel="stylesheet" href="css/swiper.min.css">
  <link rel="stylesheet" href="css/page2.css">
</head>

<body>
  <div class="navBar">
    <p class="navBackBtn backBtn">
      <i></i>
      <span>返回</span>
    </p>
    <p class="titleName">产品详情</p>
  </div>
  <div id="con">
    <!--轮播图片-->
    <div class="carImgs">
      <div class="swiper-container">
        <div class="swiper-wrapper">
          <!--<div class="swiper-slide">
          <a href="carPicture2.html">
            <img class="detailImg" src="" alt="">
          </a>
        </div>
         <div class="swiper-slide">
           <a href="carPicture3.html">
             <img class="detailImg" src="" alt="">
           </a>
         </div>-->
        </div>
        <!-- 如果需要分页器 -->
        <div class="swiper-pagination"></div>
      </div>
      <div class="carInfo">
        <p class="txt carName"></p>
        <div class="txt">
          <p class="priceInfo part">
            市场指导价: <span class="priceNum"></span>
          </p>
          <p class="dellNum part">
            预约数: <span class="priceNum"></span>
          </p>
        </div>
      </div>
    </div>
    <!--方案-->
    <div class="plans">
      <div class="title">
        <p class="left active">方案一(1+3)</p>
        <p class="right">方案二(3年期)</p>
      </div>
      <!--方案一-->
      <div class="boxWrap">
        <div class="box box1">
          <div class="planImg planImg1">
            <img src="images/plan1.png" alt="">
            <p class="txt txt1">首期支付</p>
            <p class="txt txt2">一年租金</p>
            <p class="txt txt3">尾款支付<br>或再分期三年</p>
            <p class="txt txt4">车辆<br>价值</p>
          </div>
          <div class="priceDetail">
            <p class="p-title">
              <span class="left"></span>
              <span class="middle">先用一年</span>
              <span class="right"></span>
            </p>
            <div class="detail detail1">
              <p class="txt1">首付10%</p>
              <p class="txt2 moneyNum">¥0</p>
              <p class="txt3">月供</p>
              <p class="txt4 moneyNum">¥0</p>
              <p class="txt5">含购置税/含保险等费用</p>
            </div>
            <p class="p-title p-title2">
              <span class="left"></span>
              <span class="middle">尾款购车</span>
              <span class="right"></span>
            </p>
            <div class="detail detail2">
              <p class="txt1">分期付款</p>
              <p class="txt2"><span class="moneyNum">¥月</span></p>
              <p class="txt3">一次性付清：<span>请咨询业务人员</span></p>
              <p class="txt4">尾款可选方案：一、1年后还车（限公里数）</p>
              <p class="txt5">二、1年后付尾款购车 </p>
              <p class="txt5">三、1年后尾款再分期三年</p>

            </div>
          </div>
        </div>
        <!--方案二(3年期)-->
        <div class="box box2 boxHide">
          <div class="planImg planImg2">
            <img src="images/plan2.png" alt="">
            <p class="txt txt1">三年月租金</p>
            <p class="txt txt2">首付租金</p>
            <p class="txt txt3">车辆价值</p>
          </div>
          <table id="priceTab" cellpadding="0" cellspacing="0">
            <tr class="firstTr">
              <th>首付</th>
              <th>首期支付</th>
              <th>月租金</th>
            </tr>
            <tr>
              <td class="list1">10%</td>
              <td class="list2 moneyNum">¥0</td>
              <td class="list3 moneyNum">¥0</td>
            </tr>
            <tr>
              <td class="list1">20%</td>
              <td class="list2 moneyNum">¥0</td>
              <td class="list3 moneyNum">¥0</td>
            </tr>
            <tr>
              <td class="list1">30%</td>
              <td class="list2 moneyNum">¥0</td>
              <td class="list3 moneyNum">¥0</td>
            </tr>
          </table>
          <div class="txt11 ">
            <p class="left">
              <span>说明:</span>
            </p>
            <p class="right">
              <span>1、3年租赁期,到期过户;</span>
              <span>2、含购置税，保险等费用。</span>
            </p>
          </div>
        </div>
      </div>
    </div>
    <!--查看车辆信息-->
    <div class="carIntr">
      <p class="title">
        <span class="left">查看车辆信息</span>
        <span class="right">
              <img src="images/inputBg.png" alt="">
            </span>
      </p>
    </div>
    <!--门店地址-->
    <div class="address">
      <div class="shopAddress">
        <p class="title">
          <span class="left"></span>
          <span class="middle">门店地址</span>
          <span class="right"></span>
        </p>
      </div>
      <div class="addressBox">
        <p class="company">广州海城店</p>
        <p class="addressDetail">广州市黄浦区黄埔东路1773号</p>
        <span class="icon"><img src="images/address.png"></span>
        <p class="distance">
          <!--4.7km-->
          <span class="storeDistance"></span>
          <!--离我最近-->
          <span class="lately">离我最近</span>
        </p>
      </div>
    </div>
    <!--查看全部门店地址-->
    <div class="allShop">
      <p class="title">
        <span class="left">查看全部1家门店</span>
        <span class="right">
              <img src="images/inputBg.png" alt="">
            </span>
      </p>
    </div>
    <!--申请流程-->
    <div class="applyPro">
      <p class="title">
        <span class="left"></span>
        <span class="middle">申请流程</span>
        <span class="right"></span>
      </p>
      <div class="proBox">
        <div class="part part1">
          <p class="p-img">
            <img src="images/pro1.png" alt="">
          </p>
          <span class="txt">选中车型<br>在线申请</span>
          <span class="line"></span>
        </div>
        <div class="part part2">
          <p class="p-img">
            <img src="images/pro2.png" alt="">
          </p>
          <span class="txt">客服致电<br>指引购车</span>
          <span class="line"></span>
        </div>
        <div class="part part3">
          <p class="p-img">
            <img src="images/pro3.png" alt="">
          </p>
          <span class="txt">店内看车<br>完成签约</span>
          <span class="line"></span>
        </div>
        <div class="part part4">
          <p class="p-img">
            <img src="images/pro4.png" alt="">
          </p>
          <span class="txt">店内提车</span>
        </div>
      </div>
    </div>
    <!--申请资料-->
    <div class="applyFiles">
      <p class="title">
        <span class="left"></span>
        <span class="middle">申请资料</span>
        <span class="right"></span>
      </p>
      <div class="fileBox">
        <div class="part part1">
          <p class="f-img">
            <img src="images/file2.png" alt="">
          </p>
          <span class="txt">身份证</span>
        </div>
        <div class="part part2">
          <p class="f-img">
            <img src="images/file1.png" alt="">
          </p>
          <span class="txt">驾驶证</span>
        </div>
        <div class="part part3">
          <p class="f-img">
            <img src="images/file3.png" alt="">
          </p>
          <span class="txt">征信授权</span>
        </div>
      </div>
    </div>
    <!--猜你喜欢-->
    <div class="like">
      <p class="title">
        <span><img src="images/like.png" alt=""></span>
        <span class="guessLike">猜你喜欢</span>
      </p>
    </div>
    <!--猜你喜欢的车-->
    <div class="likeCar">
      <div class="likeInfo box1">
        <div class="carImg">
          <img src="images/icon_guessLike_default.png" />
        </div>
        <div class="carPrice">
          <h3>福克斯 2017款 1.6L自动舒适型（两厢）</h3>
          <p>首期支付 <span class="redColor">&yen;</span><span class="red"> 0</span></p>
          <p>首年月租 <span class="blueColor">&yen;</span><span class="blue">0</span></p>
          <p class="safe">含购置税保险等</p>
        </div>
      </div>
      <div class="likeInfo box2">
        <div class="carImg">
          <img src="images/icon_guessLike_default.png" />
        </div>
        <div class="carPrice">
          <h3>福克斯 2017款 1.6L自动舒适型（两厢）</h3>
          <p>首期支付 <span class="redColor">&yen;</span><span class="red">0</span></p>
          <p>首年月租 <span class="blueColor">&yen;</span><span class="blue">0</span></p>
          <p class="safe">含购置税保险等</p>
        </div>
      </div>
    </div>
    <!--拨打电话,立即申请-->
    <div class="bottom">
      <div class="left">
        <div class="con">
          <i></i>
          <p class="free">免费咨询</p>
          <P class="time">(9:00-18:00)</P>
        </div>
        <a href="tel:4009987103" style="display:block;height:0.98rem;width:40%;line-height:0.98rem;text-align:center;position:absolute;left:0;top:0; z-index:100;opacity:0;">400-9987-103</a>
      </div>
      <div class="right">
        <a>立即申请</a>
      </div>
    </div>
  </div>
  <script src="js/jquery-1.7.2.min.js"></script>
  <script src="js/swiper.min.js"></script>
  <script type="text/javascript">
  //1.定义全局变量
    var carModelIdVal = ""; //提供给Android传过来的键值对拼接在url上
    var productIdVal = ""; //提供给Android传过来的键值对拼接在url上
    var mSelectStute = 0; //定义点击"返回"按钮做跳转状态,默认为0
    var carInfo = ""; //请求后台的数据传给Android
    var planInfo = ""; //请求后台的数据传给Android
    var storeAddress = ""; //门店地址
    var storeCount = 0; //门店数量默认为0
    var selectStatu = 0; //记录选中的方案类型的状态
    var mAppointmentCount = 0; //定义预约人数，默认为0，动态相加计算预约数
    var productName = ""; //定义产品名称
    var mCurCityName = ""; //当前城市名称
    var mLongitude = ""; //当前城市经度
    var mLatitude = ""; //当前城市维度

  //2.定义默认地址(地址为null或者请求失败，传递默认地址数据)
    var storeAdd = "{\n" +
      "            \"address\": \"广州市黄埔区黄埔东路1773号\",\n" +
      "            \"distance\": \"28.5公里\",\n" +
      "            \"id\": \"5\",\n" +
      "            \"latitude\": \"23.093443\",\n" +
      "            \"longitude\": \"113.495991\",\n" +
      "            \"sname\": \"广州海城店\",\n" +
      "            \"value\": \"28504\"\n" +
      "        }";
  //3.获取url中"?"符后的值:?carModelIdVal=2016091400032121&productIdVal=5**/
    GetQueryString(productIdVal);
    function GetQueryString(name) {
      var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
      var url = window.location.search;
      //console.log(url);
      var theRequest = new Object();
      if (url.indexOf("?") != -1) {
        var str = url.substr(1);
        strs = str.split("&");
        for (var i = 0; i < strs.length; i++) {
          theRequest[strs[i].split("=")[0]] = (strs[i].split("=")[1]);
        }
        /**拿到url的值转化为字符串:{"carModelIdVal":"2017101800000006","productIdVal":"6"}**/
      }
      // console.log('theRequest', theRequest); //自定义打印
      /**拿到值,让Android把值传url后面拼接上**/
      carModelIdVal = theRequest.carModelIdVal;
      productIdVal = theRequest.productIdVal;
      mSelectStute = theRequest.selectStute;
      mCurCityName = decodeURI(theRequest.curCityname);
      mLatitude = theRequest.latitude;
      mLongitude = theRequest.longitude;
    }
  //4.顶部轮播图
    carImage(); 
    /*产品详情轮播banner图片调用后台接口,将图片渲染页面*/
    function carImage() {
      var box;
      $.ajax({
        type: "GET",
        async: false,
        dataType: "json",
        headers: {
          "Content-Type": "application/json;charset=UTF-8"
        },
        url: baseUrl + "product/selectCarBanner?productId=" + productIdVal,
        success: function (data) {
          box = data;
          console.log(data);
        }
      });
      var s = "";
      for (var key in box.result) {
        s += "<div class='swiper-slide'>";
        s += "<a href='" + jumpUrl + "carPicture2.html?productId=" + box.result[key].productId + "&carModelId=" +
          carModelIdVal + "'>";
        s += "<img class='detailImg' src='" + box.result[key].bannerImage + "'/>";
        s += "</a>";
        s += "</div>";
      }

      $('.swiper-wrapper').append(s);
    };
  //5.调用后台车辆详情查询接口，将数据渲染页面**/
    carModel();
    function carModel() {
      $.ajax({
        type: "GET",
        headers: {
          "Content-Type": "application/json;charset=UTF-8"
        },
        url: baseUrl + 'product/selectCarInfo?carModelId=' + carModelIdVal + "&productId=" + productIdVal,
        success: function (data) {
          //获取后台车辆名称、指导价、预约数
          var results = JSON.parse(data).result;
          // console.log("辆详情查询", results)
          carInfo = JSON.stringify(results);
          productName = results.productName;
          var newPrice = (results.newPrice) / 10000; //将指导价元转换成万单位
          mAppointmentCount = parseInt(results.appointmentCount); //获取预约数,将string类型转为整型
          //修改车辆名称、指导价、预约数
          $('.carImgs .carInfo .carName').html(productName);
          var carName = $('.carImgs .carInfo .carName').html();

          //NaN输出判断
          if (isNaN(newPrice)) {
            $('.carImgs .priceInfo .priceNum').html(0 + '万');
          } else {
            $('.carImgs .priceInfo .priceNum').html(newPrice + "万");
          }

          //NaN输出判断
          if (isNaN(mAppointmentCount)) {
            $('.carImgs .dellNum .priceNum').html(0 + "人");
          } else {
            $('.carImgs .dellNum .priceNum').html(mAppointmentCount + "人");
          }

          //车辆名称长度超出范围溢出显示
          if (carName.length > 20) {
            var $carName = $('.carImgs .carInfo .carName');
            $carName.css({
              "overflow": "hidden",
              "text-overflow": "ellipsis",
              "white-space": "nowrap"
            });
          }
        },
        error: function (data) {
          //console.log('失败');
        }
      });
    }
  //6.动态加载预约人数,android给h5传预约成功参数，安卓调用sendApplyAddOne方法
    function sendApplyAddOne(count) { //安卓调用方法
      appointmentSum = mAppointmentCount + parseInt(count); //请求后台的预约数+android传预约成功参数
      $('.carImgs .dellNum .priceNum').html(appointmentSum + "人"); //将预约总数渲染页面
    }
  //7.调用后台方案列表查询接口，将数据渲染页面**/
    plan(); 
    function plan() {
      $.ajax({
        type: "GET",
        headers: {
          "Content-Type": "application/json;charset=UTF-8"
        },
        url: baseUrl + "product/selectProgram?productId=" + productIdVal,
        success: function (data) {
          var results = JSON.parse(data).result;
          // console.log('后台方案列表', results); //自定义打印
          planInfo = JSON.stringify(results);

          /**
           * 点击方案列表时，当前元素添加背景颜色，其它列表背景移除；
           * 如果下面列表box的下标等于被点击方案下标一致时移除boxHide类，其它列表
           * box添加boxHide类
           */
          $('.plans .title p').click(function () {
            $(this).addClass('active').siblings().removeClass('active');
            $('.plans .boxWrap .box').eq($(this).index()).show().siblings().hide();

          });
          var isHideArr = [];
          for (var i = 0; i < results.length; i++) {
            isHideArr.push(results[i].planType); //收集方案类型，方便判断是否相同
            //方案一首付,月供动态加载
            if (results[i].planType == 1) {
              // console.log("aa",results[i].ndownPayment);
              // console.log("bb",results[i].modifiedDate);
              $('.detail1 .txt2').html("¥" + results[i].ndownPayment); //首付
              $('.detail1 .txt4').html("¥" + results[i].nmonthlyPayment); //月供
              $('.detail2 .txt2 span:first-child').html("¥" + results[i].mmonthlyPayment + "x" + results[i].mMonth +
                "月"); //分期付款
            } else {
              //方案二首付,月租金动态加载
              if (results[i].monthlyRatio == 0.1) {
                $('#priceTab tr:nth-child(2) .list1').html(results[i].monthlyRatio * 100 + "%");
                $('#priceTab tr:nth-child(2) .list2').html("¥" + results[i].mdownPayment);
                $('#priceTab tr:nth-child(2) .list3').html("¥" + results[i].mmonthlyPayment);
              }
              if (results[i].monthlyRatio == 0.2) {
                $('#priceTab tr:nth-child(3) .list1').html(results[i].monthlyRatio * 100 + "%");
                $('#priceTab tr:nth-child(3) .list2').html("¥" + results[i].mdownPayment);
                $('#priceTab tr:nth-child(3) .list3').html("¥" + results[i].mmonthlyPayment);
              }
              if (results[i].monthlyRatio == 0.3) {
                $('#priceTab tr:last-child .list1').html(results[i].monthlyRatio * 100 + "%");
                $('#priceTab tr:last-child .list2').html("¥" + results[i].mdownPayment);
                $('#priceTab tr:last-child .list3').html("¥" + results[i].mmonthlyPayment);
              }
            }
          };
          // 判断数组是否全部重复
          if (isAllEqual(isHideArr)) {
            $('.plans .title').hide();
          };

          function isAllEqual(array) {
            if (array.length > 0) {
              return !array.some(function (value, index) {
                return value !== array[0];
              });
            } else {
              return true;
            }
          };
          //如果没有方案一或方案二就隐藏对就内容
          // console.log("aaa",isHideArr)
          if (isHideArr.indexOf("1") == -1) {
            $('.planType .middle').html("产品方案2 (3年期)");
            $('.boxWrap .box1').hide();
            $('.boxWrap .box2').show();
          } else {
            $('.planType .middle').html("产品方案1 (1+3)");
            $('.boxWrap .box1').show();
            $('.boxWrap .box2').hide();
          }

          //如果产品是华晨中华7或者8就把方案切换隐藏
          // if (results[0].planType == 2) {
          //   $('.planType .middle').html("产品方案2 (3年期)");
          //   $('.boxWrap .box1').hide();
          //   $('.boxWrap .box2').show();
          // } else {
          //   $('.planType .middle').html("产品方案1 (1+3)");
          //   $('.boxWrap .box1').show();
          //   $('.boxWrap .box2').hide();
          // }
          // if (productIdVal == "7" || productIdVal == "8") {
          //   $('.plans .title').hide();
          // }
        }

      });
    }
    //选择方案一
    $('.plans .left').click(function () {
      selectStatu = 0;
    });
    //选择方案二
    $('.plans .right').click(function () {
      selectStatu = 1;
    });
  //8.点击查看车辆信息跳转至车辆信息页面**/
    $('.carIntr').click(function () {
      debugger;
      location.href = jumpUrl + "carDetail.html?carModelIdVal=" + carModelIdVal + "&productIdVal=" + productIdVal;
    });
  //9.渲染店面地址
    /**
     * 提供给Android调用的方法，将选择的门店信息传过来
     * @param js  城市Object
     * @param isRecent  是定位成功
     */
    /**调用Android门店列表接口,将数据渲染界面**/
    function sendStoreAddressToJs(js, isRecent) { //原生安卓调用
      var cityName = js.city;
      cityName = cityName.substring(0, cityName.indexOf("市") + 1);
      var lat = js.latitude;
      var longitude = js.longitude;
      requestNetworkGetStoreAddress(cityName, longitude, lat);
    }
    /**
     * 获取当前城市对应的门店地址
     * @param {Object} cityName  城市名称
     * @param {Object} longitude  经度
     * @param {Object} latitude    维度
     */
    function requestNetworkGetStoreAddress(cityName, longitude, latitude) {
      //请求之前校验
      if (cityName != null && cityName != "" && cityName != undefined) {
        $.ajax({
          type: "GET",
          headers: {
            "Content-Type": "application/json;charset=UTF-8"
          },
          url: decodeURI(baseUrl + "store/get?cityname=" + cityName + "&longitude=" + longitude + "&latitude=" +
            latitude),
          success: function (data) {
            /*data不为空时将数据渲染页面,选择下标为0最近那笔数据*/
           data = JSON.parse(data);
            if (data.result.length != 0) {
              storeCount = data.result.length; //计算门店数量
              var result = data.result[0]; //取下标为0的这一条数据
              storeAddress = JSON.stringify(result);
              var storeName = result.sname;
              var address = result.address;
              var distance = result.distance; //获得公里数加单位
              var value = result.value; //获得公里数
              //TODO 渲染界面
              $('.address .addressBox .company').html(storeName);
              $('.address .addressDetail').html(address);
              $('.allShop .title .left').html("查看全部" + storeCount + "家门店");
              //window.NativeMethod.testBackData(value);
              if (value == undefined || value == null || value == '') {
                $('.address .addressBox .distance').hide();
                $('.address .addressBox .icon').css("margin-top", "-1.2rem");
              } else {
                $('.address .addressBox .storeDistance').html(distance);
                $('.address .distance .lately').show();
              }
            }
          },
          error: function (data) {
            $('address').hide();
            $('allShop').hide();
          }
        });
      }
    };

  //10.点击门店地址时,调用Android的门店地址方法**/
    $('#con .addressBox').click(function () {
      callBaidunNvigation();
    });
      /**
     * 打开百度导航
     * 调用android原生方法,需要将门店地址传过去
     */
     function callBaidunNvigation() {
      if (storeAddress == '') {
        storeAddress = storeAdd;
      };
      if (iosOrAn == "Android") {
        window.NativeMethod.callBaiduNva(storeAddress); //调用安卓方法
      } else {
        //调用IOS方法
      };
    }
  //11.查看全部门店
   /*点击查看全部门店调用后台门店地址数据*/
    $('#con .allShop').click(function () {
      if (storeCount == 1) { //门店数量为1时,不能点击跳转
        return false;
      };
      openStoreAddressSelect();
    });
    /**
     * 调用android的方法门店地址选择器
     * 打开门店选择界面
     */
     function openStoreAddressSelect() {
      if (iosOrAn == "Android") {
        window.NativeMethod.callStoreAddressSelect(storeAddress);
      } else {
        //IOS
      };
    }
    /**
     *  选择门店后，Android返回数据到门店地址当前界面刷新数据
     */
    function selectStoreAddress(js) {
      storeAddress = JSON.stringify(js);
      var storeName = js.sname;
      var address = js.address;
      var distanceVale = js.distance;
      var count = js.position;
      //渲染界面
      $('.addressBox .company').html(storeName);
      $('.addressBox .addressDetail').html(address);
      $('.addressBox .distance .storeDistance').html(distanceVale);
      if (count == 0 && distanceVale != null && distanceVale != undefined) {
        //显示离我最近
        $('.address .distance .lately').show();
      } else {
        //隐藏布局
        $('.address .distance').hide();
      }
    }
  //12.猜你喜欢列表查询口
    lovely();
    function lovely() {
      var lovelyOne;
      var lovelyTwo;
      var account = '';
      $.ajax({
        type: "GET",
        headers: {
          "Content-Type": "application/json;charset=UTF-8"
        },
        url: baseUrl + "product/selectUserLovelyList?account=" + account,
        success: function (data) {
          var results = JSON.parse(data).result;
          // console.log('猜你喜欢', results); //自定义打印
          lovelyOne = results[0];
          lovelyTwo = results[1];
          /**方案类型为2,将值赋值给box1**/
          var name1 = lovelyOne.name;
          var ndownPayment1 = lovelyOne.ndownPayment;
          var nmonthlyPayment1 = lovelyOne.nmonthlyPayment;
          var description1 = lovelyOne.description;
          var imge1 = lovelyOne.image;
          $('.likeCar .box1 h3').html(name1);
          $('.likeCar .box1 .red').html(ndownPayment1);
          $('.likeCar .box1 .blue').html(nmonthlyPayment1);
          $('.likeCar .box1 .safe').html(description1);
          $('.likeCar .box1 .carImg img').attr('src', jumpUrl + imge1);
          /*单击猜你喜欢一重新请求数据刷新，同时设置选中背景颜色和返回到顶部*/
          $('#con .likeCar .box1').click(function () {
            document.body.scrollTop = document.documentElement.scrollTop = 0;
            carModelIdVal = lovelyOne.carModelId;
            productIdVal = lovelyOne.productId;
            carModel();
            plan();
            onTouch();
          });

          /**方案类型为1,将值赋值给box2**/
          var name2 = lovelyTwo.name;
          var ndownPayment2 = lovelyTwo.ndownPayment;
          var nmonthlyPayment2 = lovelyTwo.nmonthlyPayment;
          var description2 = lovelyTwo.description;
          var imge2 = lovelyTwo.image;
          $('.likeCar .box2 h3').html(name2);
          $('.likeCar .box2 .red').html(ndownPayment2);
          $('.likeCar .box2 .blue').html(nmonthlyPayment2);
          $('.likeCar .box2 .safe').html(description2);
          $('.likeCar .box2 .carImg img').attr('src', jumpUrl + imge2);
          /*单击猜你喜欢二重新请求数据刷新,同时设置选中背景颜色和返回到顶部*/
          $('#con .likeCar .box2').click(function () {
            document.body.scrollTop = document.documentElement.scrollTop = 0;
            carModelIdVal = lovelyTwo.carModelId;
            productIdVal = lovelyTwo.productId;
            carModel();
            plan();
            onTouch();

          });
        }
      });
    };
    /*触摸猜你喜欢图片开始时背景为灰色,触摸离开背景为白色,同时要加上取消触摸，避免不小心一直选中状态*/
    function onTouch() {
      $('.likeCar .likeInfo').on('touchstart', function () {
        $(this).css("background", "#D8D8D8");
      });
      $('.likeCar .likeInfo').on('touchend', function () {
        $(this).css("background", "#fff");
      });
      $('.likeCar .likeInfo').on('touchcancel', function () {
        $(this).css("background", "#fff");
      });
    };
  //13.跳转到预约详情
    $('#con .bottom .right a').click(function () {
      openSubmitPage();
    });
     /**
     * 跳转到原生预约详情界面
     * 需要将产品信息,方案类型,门店地址
     */
     function openSubmitPage() {
      if (storeAddress == "") {
        storeAddress = storeAdd;
      };
      if (iosOrAn == "Android") {
        window.NativeMethod.callSubmitApply(carInfo, planInfo, storeAddress, selectStatu); //跳转安卓预约详情页面
      } else {
        //跳转IOS预约详情页面
      };
    }
  //14.其他
    $(function () {
      // 判断是否是微信
      if (isWeiXin()) {
        $(".navBar").hide();
        $("#con").css({
          "padding-top": "0"
        });
      } else {
        // 判断是否是安卓
        var isAndroid = navigator.userAgent.indexOf('Android') > -1 || navigator.userAgent.indexOf('Adr') > -1;
        if (isAndroid) {
          $(".navBar").css({
            "padding-top": "0"
          });
          $("#con").css({
            "padding-top": "0.88rem"
          });
          $(".navBackBtn").css({
            "top": "0.24rem"
          });
        }
      }
      // 在app里取消查看全部车型
      if (!isWeiXin() && equipment() == 'IOS') {
        $(".linkBtn").css({
          "display": "none"
        });
        $(".carImgs .backBtn").css({
          "display": "none"
        });
      }
      // 轮播
      var mySwiper = new Swiper('.swiper-container', {
        direction: 'horizontal', //水平滚动
        loop: true, //自动轮播
        autoplay: 3000, //3s切换一次
        pagination: '.swiper-pagination', // 如果需要分页器
        autoplayDisableOnInteraction: false //触摸图片后仍可继续轮播

      });
      //点击“返回”按钮判断跳转h5页面还是原生页面
      $(".backBtn").on("click", function () {
        if (!isWeiXin() && equipment() == 'IOS') {
          backToNative("popToView://backToNative");
        } else {
          if (mSelectStute == 1) {
            history.back(); //如果返回参数是1，跳转返回h5页面
          } else {
            window.NativeMethod.callDetailFinishActivity(); //调用Android的方法跳转到原生首页
          }
        }
      });
      // 钱数加逗号
      $(".moneyNum").each(function (index, ele) {
        var str = $(this).html();
        $(this).html(addComma(str))
      });

      function addComma(str) {
        var str1 = str.substring(1);
        return parseFloat(str1).toLocaleString();
      }
      if (mSelectStute == 1) {
        requestNetworkGetStoreAddress(decodeURI(mCurCityName), mLongitude, mLatitude);
      }
    });
 

  </script>
</body>

</html>